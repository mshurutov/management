[TOC]

Стандарты, правила, регламенты, требования ИБ.
==============================================

Базовый фундаментальный принцип существования корпоративной ИТ-среды: запрещено всё, что не разрешено.

Базовые требования к информационной инфраструктуре.
---------------------------------------------------

Все используемое ПО и аппаратные средства должны использовать техники и технологии единого подключения: когда сотрудник подключается к рабочему пространству внутренней сети компании, он должен иметь доступ ко всем ресурсам, необходимыми для выполнения своих должностных обязанностей без дополнительных телодвижений по вводу логинов/паролей.

При этом должна обеспечиваться недопустимость утечки конфиденциальной информации при работе из публичных сетей и/или с личных средств (ноутбуков). Т.е. рабочее пространство должно размещаться только внутри защищённого периметра компании.

Требования к написанию безопасного кода.
----------------------------------------

Уязвимостям - нет!

Требования к тестированию/среде тестирования?
---------------------------------------------


Требования к эксплуатации ПО и аппаратных ресуров ВТ.
-----------------------------------------------------

### Общесистемные требования.

Основное требование к обеспечению информационной безопасности эксплуатируемых вычислительных систем - это своевременное обновление программного обеспечения и микрокода, используемого в аппаратных средствах вычислительных систем.

#### Учётные записи и доступ к ресурсам.

##### Соглашения.
* Пользователь - тип учётной записи, имеющий привилегию подключения к ресурсу;
* Роль - тип учётной записи, НЕ имеющий привилегию подключения к ресурсу;

##### Доступ к ресурсам.
* Доступ к любым ресурсам по сети (ПО, консоли ОС, аппаратные средства, например, сетевые устройства) допустим только для учётных записей, хранящихся в централизованной системе аутентификации и авторизации. 
* Доступ к учётным записям с привилегиями суперпользователя (далее, - суперпользователь: `root` в `UNIX`-подобных операционных системах, учётная запись с привилегией `SUPERUSER` в СУБД PostgresQL) по сети недопустим!
  * приемлемо: доступ суперпользователю разрешён только локально;
  * хорошо: суперпользователь - это роль, доступ к возможностям которой в системе ограничен;
* Доступ к ресурсу допустим только посредством именованных учётных записей, хранящихся в централизованной системе управления инфраструктурой;
* неименнованная учётная запись с возможностью действий с привилегиями суперпользователя для доступа к хосту может использоваться в двух случаях:
  1. в процессе инсталляции хоста для первоначальной настройки и включения хоста в централизованную систему управления инфраструктурой;
  2. в случае сбоев сетевого оборудования, в результате которых доступ по сети к хосту становится невозможным;

### Требования к эксплуатации СУБД PostgresQL.

#### Методы аутентификации.

Аутентификация по паролю является небезопасной, независимо от способа хеширования пароля. Поэтому для аутентификации необходимо использовать либо сертификаты, либо централизованную аутентификацию.
Если же использовать сертификаты или централизованную систему по каким либо причинам не представляется возможным, то параметр `password_encryption` должен иметь значение `scram-sha-256`.

#### Ролевая модель.

Для обеспечения разграничения доступа к данным необходимо ввести ролевую модель доступа к объектам и данным БД/СУБД. Минимум ролей:
* суперпользователь, он же администратор баз данных - не имеет ограничений в рамках одного экземпляра;
* владелец базы данных - не имеет ограничений в конкретной базе данных, за исключением явно указанных владельцев схем базы данных; эта роль необходима для выполнения задач создания/изменения/удаления объектов БД;
* владелец схемы данных - не имеет ограничений в отдельной схеме базы данных; эта роль необходима для выполнения задач создания/изменения/удаления объектов схемы БД при необходимости;
* пишущий пользователь БД - роль, имеющая право изменения данных;
* читатель - роль, имеющая право только просматривать данные.

#### Ограничения доступа

После создания БД необходимо отозвать все права доступа у псевдороли PUBLIC, т.к. этих прав у данной роли многовато.

##### Ограничение доступа для суперпользователя.

Согласно общесистемным требованиям, учётная запись с привилегией `SUPERUSER` должна быть в единственном экземпляре и создаваться в момент инициализации кластера БД (по-умолчанию имеет имя `postgres`) может иметь доступ только локально: либо через сокет, либо, в случае необходимости, по адресу `127.0.0.1` для IPv4 и/или `::1` для IPv6. Любые другие сетевые подключения недопустимы. Подобное требование обеспечивается следующей конфигурацией в файле `pg_hba.conf`:

```
local   all postgres                    peer
host    all poostgres   127.0.0.1/32    ident
host    all poostgres   ::1             ident
host    all poostgres   all             reject
...
```

##### Ограничения для ТУЗ.

Доступ для технических учётных записей допустим только с хостов с прикладными ПО. Пример `pg_hba.conf` - для исторически сложившейся ситуации, когда сертификаты и централизованная аутентификация недоступны по каким-либо причинам.
```
...
host    db1 tuz1        samenet         scram-sha-256
host    db2 tuz2        samenet         scram-sha-256
...
host    dbN tuzN        samenet         scram-sha-256
```

##### Ограничения для УЗ пользователей.

**ВАЖНО!** В промышленной эксплуатации учётные записи пользователей в СУБД допустимы только тогда, когда пользователи СУБД являются пользователями информационной системы. В любом другом случае учётных записей пользователей в СУБД производственной среды быть не должно!

Для разработчиков и тестировщиков в соответствующей среде создаются УЗ с доступом из сетей, в которых регистрируются их рабочие места. Например, рабочее место получает адрес из сети `192.168.1.0/24`, соответственно `pg_hba.conf` будет выглядеть следующим образом:
```
...
host    db1 user1       192.168.1.0/24  cert
...
```
